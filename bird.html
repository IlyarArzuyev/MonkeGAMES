<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üê¶ Flappy Bird</title>
<style>
  body {
    margin: 0;
    overflow: hidden;
    background: linear-gradient(180deg, #4ec0ca 0%, #ffffff 100%);
    font-family: 'Segoe UI', sans-serif;
    text-align: center;
  }
  #gameCanvas {
    background: #70c5ce;
    display: block;
    margin: 0 auto;
    border-bottom: 3px solid #0095dd;
    touch-action: none;
  }
  #score {
    position: absolute;
    top: 10px;
    width: 100%;
    text-align: center;
    color: white;
    font-size: 2rem;
    font-weight: bold;
    text-shadow: 2px 2px 4px #000;
  }
  #restart {
    display: none;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: #ffca28;
    color: #222;
    font-weight: 700;
    border: none;
    border-radius: 12px;
    padding: 12px 25px;
    font-size: 1.2rem;
    box-shadow: 0 4px 12px rgba(0,0,0,0.25);
  }
</style>
</head>
<body>
  <div id="score">0</div>
  <canvas id="gameCanvas" width="320" height="480"></canvas>
  <button id="restart">üîÑ –ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</button>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    const scoreEl = document.getElementById("score");
    const restartBtn = document.getElementById("restart");

    const GRAVITY = 0.25;
    const JUMP = -4.6;
    const PIPE_WIDTH = 60;
    const PIPE_GAP = 110;

    let bird, pipes, score, gameOver, animation;

    function resetGame() {
      bird = { x: 60, y: canvas.height / 2, velocity: 0, radius: 12 };
      pipes = [];
      score = 0;
      gameOver = false;
      restartBtn.style.display = "none";
      scoreEl.textContent = "0";
      spawnPipes();
      cancelAnimationFrame(animation);
      loop();
    }

    function spawnPipes() {
      let lastPipeX = pipes.length ? pipes[pipes.length - 1].x : canvas.width;
      const minHeight = 50;
      const maxHeight = canvas.height - PIPE_GAP - minHeight;
      const topPipeHeight = Math.floor(Math.random() * (maxHeight - minHeight)) + minHeight;
      pipes.push({
        x: lastPipeX + 200,
        top: topPipeHeight,
        bottom: topPipeHeight + PIPE_GAP,
      });
    }

    function drawBird() {
      ctx.beginPath();
      ctx.arc(bird.x, bird.y, bird.radius, 0, Math.PI * 2);
      ctx.fillStyle = "#ffeb3b";
      ctx.fill();
      ctx.strokeStyle = "#f57f17";
      ctx.lineWidth = 2;
      ctx.stroke();
    }

    function drawPipes() {
      ctx.fillStyle = "#388e3c";
      pipes.forEach(pipe => {
        ctx.fillRect(pipe.x, 0, PIPE_WIDTH, pipe.top);
        ctx.fillRect(pipe.x, pipe.bottom, PIPE_WIDTH, canvas.height - pipe.bottom);
      });
    }

    function update() {
      bird.velocity += GRAVITY;
      bird.y += bird.velocity;

      pipes.forEach(pipe => {
        pipe.x -= 2;
      });

      if (pipes.length && pipes[0].x + PIPE_WIDTH < 0) {
        pipes.shift();
        spawnPipes();
      }

      // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–π
      if (bird.y + bird.radius > canvas.height || bird.y - bird.radius < 0) {
        gameOver = true;
      }

      pipes.forEach(pipe => {
        if (
          bird.x + bird.radius > pipe.x &&
          bird.x - bird.radius < pipe.x + PIPE_WIDTH &&
          (bird.y - bird.radius < pipe.top || bird.y + bird.radius > pipe.bottom)
        ) {
          gameOver = true;
        }
      });

      // –°—á—ë—Ç
      pipes.forEach(pipe => {
        if (!pipe.passed && bird.x > pipe.x + PIPE_WIDTH) {
          score++;
          pipe.passed = true;
          scoreEl.textContent = score;
        }
      });
    }

    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      drawPipes();
      drawBird();
    }

    function loop() {
      update();
      draw();
      if (!gameOver) {
        animation = requestAnimationFrame(loop);
      } else {
        restartBtn.style.display = "block";
      }
    }

    function flap() {
      if (!gameOver) bird.velocity = JUMP;
    }

    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
    canvas.addEventListener("click", flap);
    canvas.addEventListener("touchstart", flap);
    window.addEventListener("keydown", e => { if (e.code === "Space") flap(); });

    restartBtn.addEventListener("click", resetGame);

    // –°—Ç–∞—Ä—Ç –∏–≥—Ä—ã
    resetGame();
  </script>
</body>
</html>
