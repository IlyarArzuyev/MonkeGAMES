<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>üê¶ Flappy Bird</title>
<style>
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    -webkit-tap-highlight-color: transparent;
    -webkit-user-select: none;
    user-select: none;
  }
  
  body {
    margin: 0;
    overflow: hidden;
    background: linear-gradient(180deg, #4ec0ca 0%, #2a8a94 100%);
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    touch-action: manipulation;
  }
  
  #gameContainer {
    position: relative;
    width: 100%;
    max-width: 500px;
    height: 100%;
    max-height: 800px;
    overflow: hidden;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
    border-radius: 10px;
  }
  
  #gameCanvas {
    background: #70c5ce;
    display: block;
    width: 100%;
    height: 100%;
    border-bottom: 5px solid #0095dd;
  }
  
  #score {
    position: absolute;
    top: 20px;
    width: 100%;
    text-align: center;
    color: white;
    font-size: 3rem;
    font-weight: bold;
    text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.5);
    z-index: 10;
  }
  
  #controls {
    position: absolute;
    bottom: 20px;
    width: 100%;
    display: flex;
    justify-content: center;
    gap: 30px;
  }
  
  .control-btn {
    background: rgba(255, 255, 255, 0.7);
    border: none;
    border-radius: 50%;
    width: 70px;
    height: 70px;
    font-size: 1.8rem;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    display: flex;
    justify-content: center;
    align-items: center;
    touch-action: manipulation;
  }
  
  #restartScreen {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.7);
    display: none;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    z-index: 20;
  }
  
  #finalScore {
    color: white;
    font-size: 3rem;
    font-weight: bold;
    margin-bottom: 30px;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
  }
  
  #restartBtn {
    background: #ffca28;
    color: #222;
    font-weight: 700;
    border: none;
    border-radius: 15px;
    padding: 15px 30px;
    font-size: 1.5rem;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
    touch-action: manipulation;
  }
  
  #startScreen {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.7);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    z-index: 20;
  }
  
  #title {
    color: white;
    font-size: 3rem;
    font-weight: bold;
    margin-bottom: 20px;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
  }
  
  #instructions {
    color: white;
    font-size: 1.2rem;
    text-align: center;
    margin-bottom: 30px;
    max-width: 80%;
    line-height: 1.5;
  }
  
  #startBtn {
    background: #4CAF50;
    color: white;
    font-weight: 700;
    border: none;
    border-radius: 15px;
    padding: 15px 30px;
    font-size: 1.5rem;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
    touch-action: manipulation;
  }
  
  #orientationWarning {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.9);
    color: white;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    z-index: 100;
    padding: 20px;
  }
  
  #orientationWarning h2 {
    font-size: 2rem;
    margin-bottom: 20px;
  }
  
  #orientationWarning p {
    font-size: 1.2rem;
    max-width: 80%;
  }
  
  @media (max-height: 600px) {
    #score {
      font-size: 2.5rem;
      top: 10px;
    }
    
    .control-btn {
      width: 60px;
      height: 60px;
      font-size: 1.5rem;
    }
  }
  
  @media (max-width: 350px) {
    #score {
      font-size: 2rem;
    }
    
    .control-btn {
      width: 50px;
      height: 50px;
      font-size: 1.2rem;
    }
  }
</style>
</head>
<body>
  <div id="orientationWarning">
    <h2>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–≤–µ—Ä–Ω–∏—Ç–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ</h2>
    <p>–î–ª—è –Ω–∞–∏–ª—É—á—à–µ–≥–æ –∏–≥—Ä–æ–≤–æ–≥–æ –æ–ø—ã—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –≤ –ø–æ—Ä—Ç—Ä–µ—Ç–Ω–æ–π –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏</p>
  </div>

  <div id="gameContainer">
    <canvas id="gameCanvas"></canvas>
    <div id="score">0</div>
    
    <div id="controls">
      <button class="control-btn" id="leftBtn">‚óÄ</button>
      <button class="control-btn" id="jumpBtn">‚ñ≤</button>
      <button class="control-btn" id="rightBtn">‚ñ∂</button>
    </div>
    
    <div id="startScreen">
      <h1 id="title">Flappy Bird</h1>
      <p id="instructions">–ù–∞–∂–∏–º–∞–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –∏–ª–∏ —ç–∫—Ä–∞–Ω, —á—Ç–æ–±—ã —É–ø—Ä–∞–≤–ª—è—Ç—å –ø—Ç–∏—Ü–µ–π. –ò–∑–±–µ–≥–∞–π—Ç–µ —Ç—Ä—É–± –∏ –Ω–µ –ø–∞–¥–∞–π—Ç–µ!</p>
      <button id="startBtn">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
    </div>
    
    <div id="restartScreen">
      <div id="finalScore">0</div>
      <button id="restartBtn">üîÑ –ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</button>
    </div>
  </div>

  <script>
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏
    function checkOrientation() {
      const warning = document.getElementById('orientationWarning');
      if (window.innerHeight < window.innerWidth) {
        warning.style.display = 'flex';
      } else {
        warning.style.display = 'none';
      }
    }
    
    window.addEventListener('load', checkOrientation);
    window.addEventListener('resize', checkOrientation);
    window.addEventListener('orientationchange', checkOrientation);

    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    const scoreEl = document.getElementById("score");
    const finalScoreEl = document.getElementById("finalScore");
    const restartBtn = document.getElementById("restartBtn");
    const restartScreen = document.getElementById("restartScreen");
    const startScreen = document.getElementById("startScreen");
    const startBtn = document.getElementById("startBtn");
    const jumpBtn = document.getElementById("jumpBtn");
    const leftBtn = document.getElementById("leftBtn");
    const rightBtn = document.getElementById("rightBtn");

    // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–∞–∑–º–µ—Ä–æ–≤ canvas
    function setCanvasSize() {
      canvas.width = canvas.offsetWidth;
      canvas.height = canvas.offsetHeight;
    }
    
    setCanvasSize();
    window.addEventListener('resize', setCanvasSize);

    // –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏–≥—Ä—ã
    const GRAVITY = 0.3;
    const JUMP = -5.5;
    const PIPE_WIDTH = 70;
    const PIPE_GAP = 180; // –£–≤–µ–ª–∏—á–∏–ª —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É —Ç—Ä—É–±–∞–º–∏
    const BIRD_RADIUS = 15;
    const GROUND_HEIGHT = 50;

    let bird, pipes, score, gameOver, animation, gameStarted;
    let groundOffset = 0;

    function resetGame() {
      bird = { 
        x: canvas.width / 3, 
        y: canvas.height / 2, 
        velocity: 0, 
        radius: BIRD_RADIUS,
        rotation: 0
      };
      pipes = [];
      score = 0;
      gameOver = false;
      gameStarted = true;
      restartScreen.style.display = "none";
      startScreen.style.display = "none";
      scoreEl.textContent = "0";
      spawnPipes();
      cancelAnimationFrame(animation);
      loop();
    }

    function spawnPipes() {
      const minHeight = 60;
      const maxHeight = canvas.height - PIPE_GAP - minHeight - GROUND_HEIGHT;
      const topPipeHeight = Math.floor(Math.random() * (maxHeight - minHeight)) + minHeight;
      
      pipes.push({
        x: canvas.width,
        top: topPipeHeight,
        bottom: topPipeHeight + PIPE_GAP,
        passed: false
      });
    }

    function drawGround() {
      ctx.fillStyle = "#5cae5a";
      ctx.fillRect(0, canvas.height - GROUND_HEIGHT, canvas.width, GROUND_HEIGHT);
      
      // –¢—Ä–∞–≤–∞
      ctx.fillStyle = "#4a9c4a";
      for (let i = 0; i < canvas.width; i += 20) {
        ctx.fillRect(i, canvas.height - GROUND_HEIGHT, 10, 5);
      }
      
      // –¢–µ–∫—Å—Ç—É—Ä–∞ –∑–µ–º–ª–∏
      ctx.fillStyle = "#d2b48c";
      for (let i = 0; i < canvas.width; i += 30) {
        ctx.fillRect(i, canvas.height - GROUND_HEIGHT + 5, 15, 3);
      }
    }

    function drawBird() {
      // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ canvas
      ctx.save();
      
      // –ü–µ—Ä–µ–º–µ—â–∞–µ–º –Ω–∞—á–∞–ª–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –≤ —Ü–µ–Ω—Ç—Ä –ø—Ç–∏—Ü—ã
      ctx.translate(bird.x, bird.y);
      
      // –ü–æ–≤–æ—Ä–∞—á–∏–≤–∞–µ–º –ø—Ç–∏—Ü—É –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏
      bird.rotation = Math.max(-0.5, Math.min(0.5, bird.velocity / 10));
      ctx.rotate(bird.rotation);
      
      // –¢–µ–ª–æ –ø—Ç–∏—Ü—ã
      ctx.beginPath();
      ctx.arc(0, 0, bird.radius, 0, Math.PI * 2);
      ctx.fillStyle = "#ffeb3b";
      ctx.fill();
      ctx.strokeStyle = "#f57f17";
      ctx.lineWidth = 2;
      ctx.stroke();
      
      // –ì–ª–∞–∑
      ctx.beginPath();
      ctx.arc(5, -5, 4, 0, Math.PI * 2);
      ctx.fillStyle = "black";
      ctx.fill();
      
      ctx.beginPath();
      ctx.arc(6, -5, 1.5, 0, Math.PI * 2);
      ctx.fillStyle = "white";
      ctx.fill();
      
      // –ö–ª—é–≤
      ctx.beginPath();
      ctx.moveTo(10, 0);
      ctx.lineTo(20, 0);
      ctx.lineTo(10, 5);
      ctx.closePath();
      ctx.fillStyle = "#ff9800";
      ctx.fill();
      
      // –ö—Ä—ã–ª–æ
      ctx.beginPath();
      ctx.ellipse(-5, 5, 8, 5, 0, 0, Math.PI * 2);
      ctx.fillStyle = "#f57f17";
      ctx.fill();
      
      // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ canvas
      ctx.restore();
    }

    function drawPipes() {
      ctx.fillStyle = "#388e3c";
      pipes.forEach(pipe => {
        // –í–µ—Ä—Ö–Ω—è—è —Ç—Ä—É–±–∞
        ctx.fillRect(pipe.x, 0, PIPE_WIDTH, pipe.top);
        
        // –ù–∏–∂–Ω—è—è —Ç—Ä—É–±–∞
        ctx.fillRect(pipe.x, pipe.bottom, PIPE_WIDTH, canvas.height - pipe.bottom - GROUND_HEIGHT);
        
        // –®–ª—è–ø–∫–∏ —Ç—Ä—É–±
        ctx.fillStyle = "#2e7d32";
        ctx.fillRect(pipe.x - 5, pipe.top - 20, PIPE_WIDTH + 10, 20);
        ctx.fillRect(pipe.x - 5, pipe.bottom, PIPE_WIDTH + 10, 20);
        
        ctx.fillStyle = "#388e3c";
      });
    }

    function drawClouds() {
      ctx.fillStyle = "rgba(255, 255, 255, 0.7)";
      
      // –û–±–ª–∞–∫–æ 1
      ctx.beginPath();
      ctx.arc(100 + groundOffset * 0.2, 80, 25, 0, Math.PI * 2);
      ctx.arc(130 + groundOffset * 0.2, 70, 30, 0, Math.PI * 2);
      ctx.arc(160 + groundOffset * 0.2, 80, 25, 0, Math.PI * 2);
      ctx.fill();
      
      // –û–±–ª–∞–∫–æ 2
      ctx.beginPath();
      ctx.arc(300 + groundOffset * 0.3, 120, 20, 0, Math.PI * 2);
      ctx.arc(330 + groundOffset * 0.3, 110, 25, 0, Math.PI * 2);
      ctx.arc(360 + groundOffset * 0.3, 120, 20, 0, Math.PI * 2);
      ctx.fill();
    }

    function update() {
      if (!gameStarted || gameOver) return;
      
      // –§–∏–∑–∏–∫–∞ –ø—Ç–∏—Ü—ã
      bird.velocity += GRAVITY;
      bird.y += bird.velocity;
      
      // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª–æ–∂–µ–Ω–∏—è —Ç—Ä—É–±
      pipes.forEach(pipe => {
        pipe.x -= 2;
      });
      
      // –£–¥–∞–ª–µ–Ω–∏–µ —Ç—Ä—É–± –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ —ç–∫—Ä–∞–Ω–∞ –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö
      if (pipes.length && pipes[0].x + PIPE_WIDTH < 0) {
        pipes.shift();
      }
      
      if (pipes.length === 0 || pipes[pipes.length - 1].x < canvas.width - 200) {
        spawnPipes();
      }
      
      // –ê–Ω–∏–º–∞—Ü–∏—è –∑–µ–º–ª–∏
      groundOffset = (groundOffset + 1) % 20;
      
      // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–π
      if (bird.y + bird.radius > canvas.height - GROUND_HEIGHT || bird.y - bird.radius < 0) {
        gameOver = true;
      }
      
      pipes.forEach(pipe => {
        if (
          bird.x + bird.radius > pipe.x &&
          bird.x - bird.radius < pipe.x + PIPE_WIDTH &&
          (bird.y - bird.radius < pipe.top || bird.y + bird.radius > pipe.bottom)
        ) {
          gameOver = true;
        }
      });
      
      // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç–∞
      pipes.forEach(pipe => {
        if (!pipe.passed && bird.x > pipe.x + PIPE_WIDTH) {
          score++;
          pipe.passed = true;
          scoreEl.textContent = score;
        }
      });
    }

    function draw() {
      // –û—á–∏—Å—Ç–∫–∞ canvas
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      
      // –†–∏—Å–æ–≤–∞–Ω–∏–µ –Ω–µ–±–∞
      ctx.fillStyle = "#70c5ce";
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      
      // –†–∏—Å–æ–≤–∞–Ω–∏–µ –æ–±–ª–∞–∫–æ–≤
      drawClouds();
      
      // –†–∏—Å–æ–≤–∞–Ω–∏–µ —Ç—Ä—É–±
      drawPipes();
      
      // –†–∏—Å–æ–≤–∞–Ω–∏–µ –∑–µ–º–ª–∏
      drawGround();
      
      // –†–∏—Å–æ–≤–∞–Ω–∏–µ –ø—Ç–∏—Ü—ã
      drawBird();
      
      // –ï—Å–ª–∏ –∏–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
      if (gameOver) {
        finalScoreEl.textContent = score;
        restartScreen.style.display = "flex";
      }
    }

    function loop() {
      update();
      draw();
      if (!gameOver && gameStarted) {
        animation = requestAnimationFrame(loop);
      }
    }

    function flap() {
      if (!gameStarted) {
        resetGame();
        return;
      }
      
      if (!gameOver) {
        bird.velocity = JUMP;
      }
    }

    function moveLeft() {
      if (!gameOver && gameStarted) {
        bird.x = Math.max(bird.radius, bird.x - 15);
      }
    }

    function moveRight() {
      if (!gameOver && gameStarted) {
        bird.x = Math.min(canvas.width - bird.radius, bird.x + 15);
      }
    }

    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
    canvas.addEventListener("click", flap);
    canvas.addEventListener("touchstart", function(e) {
      e.preventDefault();
      flap();
    }, { passive: false });
    
    jumpBtn.addEventListener("click", flap);
    jumpBtn.addEventListener("touchstart", function(e) {
      e.preventDefault();
      flap();
    }, { passive: false });
    
    leftBtn.addEventListener("click", moveLeft);
    leftBtn.addEventListener("touchstart", function(e) {
      e.preventDefault();
      moveLeft();
    }, { passive: false });
    
    rightBtn.addEventListener("click", moveRight);
    rightBtn.addEventListener("touchstart", function(e) {
      e.preventDefault();
      moveRight();
    }, { passive: false });
    
    window.addEventListener("keydown", e => { 
      if (e.code === "Space") flap();
      if (e.code === "ArrowLeft") moveLeft();
      if (e.code === "ArrowRight") moveRight();
    });

    restartBtn.addEventListener("click", resetGame);
    startBtn.addEventListener("click", resetGame);

    // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ —Å–∫—Ä–æ–ª–ª–∞ –ø—Ä–∏ –∫–∞—Å–∞–Ω–∏–∏
    document.addEventListener('touchmove', function(e) {
      if (e.target === canvas || 
          e.target === jumpBtn || 
          e.target === leftBtn || 
          e.target === rightBtn) {
        e.preventDefault();
      }
    }, { passive: false });

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
    setCanvasSize();
    draw();
  </script>
</body>
</html>
